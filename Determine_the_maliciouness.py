import pandas as pd

# Load the dataset
file_path = 'C:\\Users\\john3\\Desktop\\Pandas\\apiminer_features.csv'
data = pd.read_csv(file_path)

# Define a function to detect malware based on API calls
def is_malware(api_calls):
    malicious_apis = ['CreateRemoteThread', 'SetWindowsHookEx', 'RegSetValueEx', 'VirtualAllocEx']
    return int(any(api in api_calls for api in malicious_apis))

# Assuming the dataset has a column 'api_calls' with comma-separated values
if 'api_calls' in data.columns:
    # Debug: Print some API calls to check content
    print("Sample API calls:", data['api_calls'].head(10))
    
    data['IsMalware'] = data['api_calls'].apply(lambda x: is_malware(x.split(',')))
else:
    print("API calls column missing")
    data['IsMalware'] = 0  # Default to benign if column is missing

# Save the results to a new CSV file
output_file_path = 'malware_classification.csv'
data[['filename', 'IsMalware']].to_csv(output_file_path, index=False)

print("Data saved to", output_file_path)