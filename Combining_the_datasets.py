import pandas as pd

def combine_datasets(static_path, dynamic_path, output_path):
    try:
        static_features = pd.read_csv(static_path)
        dynamic_features = pd.read_csv(dynamic_path)
    except FileNotFoundError as e:
        print(f"Error loading files: {e}")
        return

    # Normalize column names
    static_features.columns = [col.lower() for col in static_features.columns]
    dynamic_features.columns = [col.lower() for col in dynamic_features.columns]

    # Debugging data previews
    print("Sample data from Static Features:")
    print(static_features.head())
    print("Sample data from Dynamic Features:")
    print(dynamic_features.head())

    # Merge the datasets on the 'filename' column, using outer join for debugging
    combined_features = pd.merge(static_features, dynamic_features, on='filename', how='outer')
    
    # Save the combined dataset to a new CSV file
    combined_features.to_csv(output_path, index=False)
    print(f"Combined dataset saved to {output_path}")

# Define file paths
static_feature_path = 'C:\\Users\\john3\\Desktop\\Pandas\\static_features.csv'
dynamic_feature_path = 'C:\\Users\\john3\\Desktop\\Pandas\\apiminer_features.csv'
output_combined_path = 'C:\\Users\\john3\\Desktop\\Pandas\\combined_feature_matrix.csv'

# Call the function
combine_datasets(static_feature_path, dynamic_feature_path, output_combined_path)